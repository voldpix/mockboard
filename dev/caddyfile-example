localhost:80 {
    rate_limit {
        zone other_req {
            key {remote_host}
            events 60
            window 1m
        }
        zone mock_exec {
            key {remote_host}
            events 30
            window 1m
        }
        zone board_create {
            key {remote_host}
            events 3
            window 1h
        }
    }

    @api {
        path /api/*
    }
    handle @api {
        rate_limit ui_api
        reverse_proxy mockboard:8888 {
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
        }
    }

    @board_create {
        path /api/boards
        method POST
    }
    handle @board_create {
        rate_limit board_create
        reverse_proxy mockboard:8888 {
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
        }
    }

    @mock_exec {
        path /m/*
    }
    handle @mock_exec {
        rate_limit mock_exec
        reverse_proxy mockboard:8888 {
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
        }
    }

    reverse_proxy mockboard:8888 {
        header_up X-Real-IP {remote_host}
        header_up X-Forwarded-For {remote_host}
    }
}